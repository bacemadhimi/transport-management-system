<mat-card class="user-form-card">
  <header class="user-form-card__header">
    <div>
      <h2>{{ data.userId ? 'Modifier utilisateur' : 'Ajouter utilisateur' }}</h2>
    </div>
  </header>

  <form [formGroup]="userForm" (ngSubmit)="onSubmit()" class="user-form-grid">
    <div class="form-row">
      <div class="form-field-group">
        <mat-label>Nom complet</mat-label>
        <mat-form-field appearance="outline" class="user-field">
          <input matInput formControlName="name" placeholder="Ex: John Doe" />
          <mat-error *ngIf="userForm.get('name')?.hasError('required')">Nom obligatoire</mat-error>
          <mat-error *ngIf="userForm.get('name')?.hasError('minlength')">Minimum 2 caractères</mat-error>
        </mat-form-field>
      </div>

      <div class="form-field-group">
        <mat-label>Email</mat-label>
        <mat-form-field appearance="outline" class="user-field">
          <input matInput type="email" formControlName="email" placeholder="Ex: john.doe@example.com" />
          <mat-error *ngIf="userForm.get('email')?.hasError('required')">Email obligatoire</mat-error>
          <mat-error *ngIf="userForm.get('email')?.hasError('email')">Format email invalide</mat-error>
        </mat-form-field>
      </div>
    </div>

    <div class="form-row">
      <div class="form-field-group">
        <mat-label>Rôle</mat-label>
        <mat-form-field appearance="outline" class="user-field">
          <mat-select formControlName="role">
            <mat-option *ngFor="let r of roles" [value]="r">{{ r }}</mat-option>
          </mat-select>
          <mat-error *ngIf="userForm.get('role')?.hasError('required')">Le rôle est obligatoire</mat-error>
        </mat-form-field>
      </div>

      <div class="form-field-group">
        <mat-label>Téléphone</mat-label>
        <mat-form-field appearance="outline" class="user-field">
          <input matInput formControlName="phone" placeholder="Ex: 55123456" />
          <mat-error *ngIf="userForm.get('phone')?.hasError('required')">Téléphone obligatoire</mat-error>
          <mat-error *ngIf="userForm.get('phone')?.hasError('pattern')">Exactement 8 chiffres</mat-error>
        </mat-form-field>
      </div>
    </div>

    <div class="form-row">
      <div class="form-field-group">
        <mat-label>Mot de passe</mat-label>
        <mat-form-field appearance="outline" class="user-field">
          <input matInput formControlName="password" type="password" placeholder="••••••••" />
          <mat-hint *ngIf="data.userId">Laisser vide pour conserver le mot de passe actuel</mat-hint>
          <mat-error *ngIf="!data.userId && userForm.get('password')?.hasError('required')">Mot de passe obligatoire</mat-error>
          <mat-error *ngIf="!data.userId && userForm.get('password')?.hasError('minlength')">Minimum 6 caractères</mat-error>
        </mat-form-field>
      </div>

      <div class="form-field-group">
        <mat-label>Image de profil (URL)</mat-label>
        <mat-form-field appearance="outline" class="user-field user-field--wide">
          <input matInput formControlName="profileImage" placeholder="https://..." />
        </mat-form-field>
      </div>
    </div>

    <div class="form-footer">
      <button mat-flat-button color="primary" type="submit" [disabled]="userForm.invalid">
        {{ data.userId ? 'Enregistrer' : 'Ajouter' }}
      </button>
      <button mat-button type="button" (click)="onCancel()">Annuler</button>
    </div>
  </form>
</mat-card>