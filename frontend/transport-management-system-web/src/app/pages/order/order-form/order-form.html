<mat-card *ngIf="!showingAlert" class="order-form-card">
  <header class="order-form-card__header">
    <div>
      <h2>{{ data.orderId ? 'Modifier Commande' : 'Ajouter Commande' }}</h2>
    </div>
  </header>

  <form [formGroup]="orderForm" (ngSubmit)="onSubmit()" class="order-form-grid">
    <mat-label>Client</mat-label>
    <mat-form-field appearance="outline" class="order-field">
      <mat-select formControlName="customerId" placeholder="Sélectionner un client">
        <mat-option *ngFor="let customer of customers" [value]="customer.id">
          {{ customer.name }} ({{ customer.matricule }})
        </mat-option>
      </mat-select>
      <mat-error *ngIf="orderForm.get('customerId')?.hasError('required')">
        Le client est obligatoire
      </mat-error>
    </mat-form-field>

    <mat-label>Référence (optionnel)</mat-label>
    <mat-form-field appearance="outline" class="order-field">
      <input matInput formControlName="reference" placeholder="Ex: ORD-2024-001" />
      <mat-hint>Laissez vide pour générer automatiquement</mat-hint>
    </mat-form-field>
   <mat-label>Statut</mat-label>
<mat-form-field appearance="outline" class="order-field">
  <mat-select formControlName="status" placeholder="Sélectionner le statut">
    <mat-option [value]="orderStatusEnum.Pending">En attente</mat-option>
    <mat-option [value]="orderStatusEnum.ReadyToLoad">Prête au chargement</mat-option>
    <mat-option [value]="orderStatusEnum.InProgress">En cours de livraison</mat-option>
    <mat-option [value]="orderStatusEnum.Received">Réception</mat-option>
    <mat-option [value]="orderStatusEnum.Closed">Clôturée</mat-option>
    <mat-option [value]="orderStatusEnum.Cancelled">Annulée</mat-option>
  </mat-select>
  <mat-error *ngIf="orderForm.get('status')?.hasError('required')">
    Le statut est obligatoire
  </mat-error>
</mat-form-field>

    <mat-label>Type de commande</mat-label>
    <mat-form-field appearance="outline" class="order-field">
      <input matInput formControlName="type" placeholder="Ex: Transport, Livraison, Express" />
      <mat-error *ngIf="orderForm.get('type')?.hasError('required')">
        Le type de commande est obligatoire
      </mat-error>
    </mat-form-field>

    <mat-label>Poids (kg)</mat-label>
    <mat-form-field appearance="outline" class="order-field">
      <input matInput type="number" formControlName="weight" placeholder="Ex: 1000" step="0.1" />
      <span matSuffix>kg</span>
      <mat-error *ngIf="orderForm.get('weight')?.hasError('required')">
        Le poids est obligatoire
      </mat-error>
      <mat-error *ngIf="orderForm.get('weight')?.hasError('min')">
        Le poids doit être supérieur à 0
      </mat-error>
    </mat-form-field>

    <mat-label>Adresse de livraison (optionnel)</mat-label>
    <mat-form-field appearance="outline" class="order-field full-width">
      <textarea matInput formControlName="deliveryAddress" placeholder="Adresse complète de livraison"
                rows="3"></textarea>
    </mat-form-field>

    <mat-label>Notes (optionnel)</mat-label>
    <mat-form-field appearance="outline" class="order-field full-width">
      <textarea matInput formControlName="notes" placeholder="Notes supplémentaires"
                rows="2"></textarea>
    </mat-form-field>



    <div class="form-footer">
      <button mat-flat-button color="primary" type="submit" [disabled]="orderForm.invalid || isSubmitting">
        {{ data.orderId ? 'Enregistrer' : 'Ajouter' }}
        <mat-icon *ngIf="isSubmitting" class="spinner">hourglass_empty</mat-icon>
      </button>
      <button mat-button type="button" (click)="onCancel()">Annuler</button>
    </div>
  </form>
</mat-card>