<mat-card *ngIf="!showingAlert" class="order-form-card">
  <header class="order-form-card__header">
    <div>
      <h2>{{ data.orderId ? 'Modifier Commande' : 'Ajouter Commande' }}</h2>
    </div>
  </header>

  <form [formGroup]="orderForm" (ngSubmit)="onSubmit()" class="order-form-grid">
    <mat-label>Client</mat-label>
    <mat-form-field appearance="outline" class="order-field">
      <mat-select formControlName="customerId" placeholder="Sélectionner un client">
        <mat-option *ngFor="let customer of customers" [value]="customer.id">
          {{ customer.name }} ({{ customer.matricule }})
        </mat-option>
      </mat-select>
      <mat-error *ngIf="orderForm.get('customerId')?.hasError('required')">
        Le client est obligatoire
      </mat-error>
    </mat-form-field>

    <mat-label>Référence </mat-label>
    <mat-form-field appearance="outline" class="order-field">
      <input matInput formControlName="reference" placeholder="Ex: ORD-2024-001" />
      <mat-hint>Laissez vide pour générer automatiquement</mat-hint>
    </mat-form-field>

  

    <mat-label>Unité de chargement</mat-label>
<mat-form-field appearance="outline" class="order-field">
  <mat-select formControlName="weightUnit" required>
    <mat-option value="palette">Palette</mat-option>
    <mat-option value="carton">Carton</mat-option>
    <mat-option value="tonne">Tonne</mat-option>
  </mat-select>
  <mat-error *ngIf="orderForm.get('weightUnit')?.hasError('required')">
    L’unité est obligatoire
  </mat-error>
</mat-form-field>


   <mat-label>Poids</mat-label>
<mat-form-field appearance="outline" class="order-field">
  <input matInput type="number" formControlName="weight" step="0.01" min="0.01" />
  <span matSuffix>{{ orderForm.value.weightUnit }}</span>

  <mat-error *ngIf="orderForm.get('weight')?.hasError('required')">
    Le poids est obligatoire
  </mat-error>
</mat-form-field>

<mat-label>Date de livraison (optionnel)</mat-label>
<mat-form-field appearance="outline" class="order-field">
  <input matInput [matDatepicker]="picker" formControlName="deliveryDate" placeholder="Sélectionner une date" />
  <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
  <mat-datepicker #picker></mat-datepicker>
</mat-form-field>


    <mat-label>Adresse de livraison (optionnel)</mat-label>
    <mat-form-field appearance="outline" class="order-field full-width">
      <textarea matInput formControlName="deliveryAddress" placeholder="Adresse complète de livraison"
                rows="3"></textarea>
    </mat-form-field>

    <mat-label>Notes (optionnel)</mat-label>
    <mat-form-field appearance="outline" class="order-field full-width">
      <textarea matInput formControlName="notes" placeholder="Notes supplémentaires"
                rows="2"></textarea>
    </mat-form-field>



    <div class="form-footer">
      <button mat-flat-button color="primary" type="submit" [disabled]="orderForm.invalid || isSubmitting">
        {{ data.orderId ? 'Enregistrer' : 'Ajouter' }}
        <mat-icon *ngIf="isSubmitting" class="spinner">hourglass_empty</mat-icon>
      </button>
      <button mat-button type="button" (click)="onCancel()">Annuler</button>
    </div>
  </form>
</mat-card>